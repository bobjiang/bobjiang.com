<!DOCTYPE html>
<html lang="zh-cn">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>图解默克尔树 - DTeam 团队日志</title>
	<meta name="description" content="iden3.io 的 blog 最近发表了一篇关于默克尔树的图解文章，相当不错，特摘取了文章的图解部分。" />
	<meta name="author" content="胡键" />
	<link rel="icon" type="image/png" href=/images/favicon.png /><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="图解默克尔树" />
<meta property="og:description" content="iden3.io 的 blog 最近发表了一篇关于默克尔树的图解文章，相当不错，特摘取了文章的图解部分。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.dteam.top/posts/2020-02/%E5%9B%BE%E8%A7%A3%E9%BB%98%E5%85%8B%E5%B0%94%E6%A0%91.html" />
<meta property="article:published_time" content="2020-02-04T15:48:35+08:00" />
<meta property="article:modified_time" content="2020-02-04T15:48:35+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="图解默克尔树"/>
<meta name="twitter:description" content="iden3.io 的 blog 最近发表了一篇关于默克尔树的图解文章，相当不错，特摘取了文章的图解部分。"/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300"
		rel="stylesheet">

	<link rel="stylesheet" type="text/css" media="screen" href="https://blog.dteam.top/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://blog.dteam.top/css/main.css" /><link rel="stylesheet" type="text/css" href="https://blog.dteam.top/css/dark.css"
		media="(prefers-color-scheme: dark)"  />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
	<script src="https://blog.dteam.top/js/main.js"></script>
	
	<script type="application/ld+json">{
		  "@context": "http://schema.org",
		  "@type": "BlogPosting",
		  "headline": "图解默克尔树",
		  "genre": "",
		  "datePublished": "2020-02-04T07:48:35Z",
		  "dateModified": "2020-02-04T07:48:35Z",
		  "description": "iden3.io 的 blog 最近发表了一篇关于默克尔树的图解文章，相当不错，特摘取了文章的图解部分。",
		  "keywords" : [ "区块链", "以太坊" ],
		  "author": {
		    "@type": "Person",
		    "name": "胡键"
		  },
		  "mainEntityOfPage": {
		    "@type": "WebPage",
		    "@id": "https://blog.dteam.top/"
		  },
		  "publisher": {
		    "@type": "Organization",
		    "name": "DTeam 团队日志",
		    "logo": {
		      "@type": "ImageObject",
		      "url": "https://blog.dteam.top/images/favicon.png"
		    }
		  }
		}</script>
</head>


<body>
	<div class="container wrapper post">
		<div class="header">
	<h1 class="site-title"><a href="https://blog.dteam.top/">DTeam 团队日志</a></h1>
	<div class="site-description"><h2>Doer、Delivery、Dream</h2><nav class="nav social">
			<ul class="flat"><a href="https://github.com/DTeam-Top" title="Github"><i data-feather="github"></i></a><a href="mailto:jian.hu@shifudao.com" title="Mail"><i data-feather="mail"></i></a><a href="/index.xml" title="RSS"><i data-feather="rss"></i></a></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">主页</a>
			</li>
			
			<li>
				<a href="/posts.html">所有文章</a>
			</li>
			
			<li>
				<a href="/tools.html">工具推荐</a>
			</li>
			
			<li>
				<a href="/about.html">关于我们</a>
			</li>
			
			<li>
				<a href="/tags.html">标签</a>
			</li>
			
                        <li>
                            <div class="statistics">
                                <span id="busuanzi_container_site_pv">总访问 <span id="busuanzi_value_site_pv"></span> </span>
                                <span id="busuanzi_container_site_uv">总人气 <span id="busuanzi_value_site_uv"></span> </span>
                            </div>
                        </li>
		</ul>
	</nav>
</div>


		<div class="post-header">
			<h1 class="title">图解默克尔树</h1>
			<div class="meta">胡键 Posted at &mdash; Feb 4, 2020
				<span class="meta" id="busuanzi_container_page_pv">阅读 <span id="busuanzi_value_page_pv"></span></span>
			</div>
		</div>

		<div class="share-component" data-sites="qq,weibo,wechat,douban,twitter,facebook"
			data-description="Share.js - 一键分享到微博，QQ空间，腾讯微博，人人，豆瓣"></div>

		
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

		<div class="markdown">
			<p><a href="https://blog.iden3.io/">iden3.io 的 blog</a> 最近发表了<a href="https://blog.iden3.io/merkle-trees-visual-introduction.html">一篇关于默克尔树的图解文章</a>，相当不错，特摘取了文章的图解部分。</p>
<h2 id="heading">默克尔树规范</h2>
<p><img src="imgs/merkle-tree-specification-visual-0.png" alt="image.png"></p>
<p>包含数据的区块组成了树的叶子。</p>
<p><img src="imgs/merkle-tree-specification-visual-1.png" alt="image.png"></p>
<p>首先，为每个数据区块创建父节点，其值为它们后代数据区块的哈希。</p>
<p><img src="imgs/merkle-tree-specification-visual-2.png" alt="image.png"></p>
<p>然后，两两分组父节点，将它们值的哈希保存于上一级的树节点中。</p>
<p><img src="imgs/merkle-tree-specification-visual-3.png" alt="image.png"></p>
<p>重复此过程直至一个节点，其为树的根。</p>
<h2 id="heading-1">防篡改</h2>
<p><img src="imgs/merkle-tree-tamper-resistance-visual-0.png" alt="image.png"></p>
<p>假设叶子节点数据被恶意篡改</p>
<p><img src="imgs/merkle-tree-tamper-resistance-visual-1b.png" alt="image.png"></p>
<p>将导致上一级节点的哈希值与之不匹配</p>
<p><img src="imgs/merkle-tree-tamper-resistance-visual-2.png" alt="image.png"></p>
<p>因此不得不继续篡改该节点</p>
<p><img src="imgs/merkle-tree-tamper-resistance-visual-3.png" alt="image.png"></p>
<p>同理，不得不依次篡改上一级节点</p>
<p><img src="imgs/merkle-tree-tamper-resistance-visual-4.png" alt="image.png"></p>
<p>最终，来到了根节点，无法篡改，因为此节点在链上一直处于被跟踪的状态。</p>
<h2 id="heading-2">证明数据的有效性</h2>
<p><img src="imgs/merkle-tree-proof-of-membership-visual-0.png" alt="image.png"></p>
<p>现要证明 data0 是默克尔树的一员</p>
<p><img src="imgs/merkle-tree-proof-of-membership-visual-1.png" alt="image.png"></p>
<p>首先需要找到从数据区块到根节点的一条路径</p>
<p><img src="imgs/merkle-tree-proof-of-membership-visual-2.png" alt="image.png"></p>
<p>然后找到该路径上 data0 兄弟区块</p>
<p><img src="imgs/merkle-tree-proof-of-membership-visual-3.png" alt="image.png"></p>
<p>忽略树的其余部分，因为这些区块已经有足够信息参与计算</p>
<p><img src="imgs/merkle-tree-proof-of-membership-visual-4.png" alt="image.png"></p>
<p>递归重新计算根的值，若与链上的根的值相等，则 data0 属于默克尔树一部分</p>
<p><img src="imgs/merkle-tree-proof-of-membership-visual-5.png" alt="image.png"></p>
<p>先计算 data0 哈希，放于标记为 0 的区块中</p>
<p><img src="imgs/merkle-tree-proof-of-membership-visual-6.png" alt="image.png"></p>
<p>将 data0 的哈希结合标记为 1 的区块值计算，结果放入 4</p>
<p><img src="imgs/merkle-tree-proof-of-membership-visual-7.png" alt="image.png"></p>
<p>最终结合 4 和 5 算出根的值</p>
<p><img src="imgs/merkle-tree-proof-of-membership-visual-8.png" alt="image.png"></p>
<p>比较两者结果即可做出判断</p>
<p>关于默克尔树的其他内容，请阅读<a href="https://blog.iden3.io/merkle-trees-visual-introduction.html">原文</a>。</p>

		</div>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="flat">
					
					<li><a href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE.html">区块链</a></li>
					
					<li><a href="/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A.html">以太坊</a></li>
					
				</ul>
			</nav>
			
			
		</div></div>
	<div class="footer wrapper">
    <p><img src="/images/mingpian.png"></p>
    <nav class="nav">
        <div><a href="http://www.beian.miit.gov.cn">陕ICP备18009003号-3</a> | 
            <a href="mailto:jian.hu@shifudao.com">联系我们</a> | <a href="https://github.com/vividvilla/ezhil">Ezhil theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
        </div>
    </nav>
</div><script>feather.replace();
       (function () {
               if (window.location.href.endsWith('about.html') ||
                       window.location.href.endsWith('posts.html') ||
                       window.location.href.endsWith('localhost:1313/')) {
                       return false;
               };

               var httpRequest = new XMLHttpRequest();
               if (!httpRequest) {
                       alert('Giving up :( Cannot create an XMLHTTP instance');
                       return false;
               }

               httpRequest.onreadystatechange = alertContents;
               httpRequest.open('GET', 'https://recommend.blog.dteam.top/');
               httpRequest.send();

               function alertContents() {
                       if (httpRequest.readyState === XMLHttpRequest.DONE) {
                               if (httpRequest.status === 200) {
                                       var div = document.getElementsByTagName("div")[0];
                                       div.innerHTML += '<hr><h3 class="page-title">其他文章</h3>' + httpRequest.responseText.replace('posts',
                                               'post-header');
                               }
                       }
               }
       })();
</script><script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?7ee18e8ed5acdd8c702a82c2d1aae74e";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

</body>

</html>